...
$$
\displaylines{\quad
 \left\lceil\openup-\jot\eqalign{
  [1]\concat[2] \quad\text{where}\qquad
    [\,] \concat ys     &= ys \cr
    (x:xs) \concat ys   &= x:(xs \concat ys)}\right\rceil
\hfill\cr\hfill
 =\qquad
 {\diagram&&       &       &       &&\n1\@\dlto\xto[2,2]\\
   &       &       &       &       &\n2{!\@}\xto[3,-2]\drto\\
   &       &       &       &       &&\n3\op:\dlto\dto&&\n4\op:\dlto\dto\\
   &       &       &       &       &\n51&\n6[\,] &\n72&\n8[\,]\\
   &       &       &\n{10}\lor\dlto\drrto \go+<-3em,0em>="10"\\
   &       &\n{11}\lambda \dlto\ddto&&&\n{12}\lambda \dlto\drto\\
   &\n{13}\@\dlto\drto&&   &\n{14}\@\dlto\drto
...
